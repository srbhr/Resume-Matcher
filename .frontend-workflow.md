# Frontend Workflow Documentation

This document outlines the user flow and architecture for the Resume Matcher frontend. The application follows a "Master Resume" centric workflow, allowing users to maintain a base resume and tailor it for specific job descriptions.

## Core Workflow

### 1. Dashboard & Initialization (`/dashboard`)
The entry point of the application.
-   **State**: Checks `localStorage` for a `master_resume_id`.
-   **No Master Resume**: Displays an "Initialize Master Resume" card.
    -   Triggers `ResumeUploadDialog`.
    -   On success: Saves `resume_id` to `localStorage` and updates UI.
-   **Master Resume Exists**: Displays a "Master Resume" card.
    -   **Action**: Clicking the card navigates to the **Resume Viewer** (`/resumes/[id]`).
    -   **Clear**: A trash icon allows removing the master resume ID from local storage.
-   **Create Tailored Resume**: A "+" card opens `/tailor` (enabled only when the master resume is `ready`) with label text "Create Resume".
-   **Tailored Resume Tiles**: Fetched from `GET /api/v1/resumes/list` and rendered as grey cards that open `/resumes/[id]`.
-   **Layout**: Dashboard grid targets 5 columns at large breakpoints, with filler tiles using neutral greys to balance the canvas.
-   **Navigation**: Settings access lives in the footer as a Swiss-style orange button.

### 2. Resume Viewer (`/resumes/[id]`)
A read-only hub for a specific resume (either the Master or a Tailored version).
-   **Data Fetching**: Fetches resume details from the backend using the `id` from the URL.
-   **Processing Status**: Shows loading, processing, or failed states with appropriate messaging.
-   **Display**: Uses the `Resume` component to render the document at 250mm width with Swiss-style shadow (`shadow-[8px_8px_0px_0px_#000000]`).
-   **Navigation**: Back to Dashboard button in header.
-   **Actions**:
    -   **Edit Resume**: Navigates to `/builder?id=[id]`.
    -   **Create Resume**: Navigates to `/tailor` (using this resume as the base).
    -   **Delete Resume**: Deletes the current resume from within the viewer (Master and Tailored).

### 3. Tailoring Process (`/tailor`)
The core AI feature where a Master Resume is optimized for a specific job.
-   **Input**: Large text area for the Job Description (JD).
-   **Validation**: Enforces a minimum character count (e.g., 50 chars) to ensure valid input.
-   **Process**:
    1.  **Upload JD**: Sends JD to `/api/v1/jobs/upload`.
    2.  **Improve**: Calls `/api/v1/resumes/improve` with `master_resume_id` and `job_id`.
-   **Output**:
    -   Redirects to the **Resume Viewer** (`/resumes/[new_id]`) for the newly created resume.
    -   The new resume is saved in the backend and can be edited further.

### 4. Resume Builder (`/builder`)
The editor interface for modifying resume content.
-   **Navigation**: Back to Dashboard button in header with Swiss styling.
-   **Modes**:
    -   **Create/Preview Mode**: If accessed via the tailored flow (data passed via `ResumePreviewContext`).
    -   **Edit Mode**: If accessed via URL query param (`?id=xyz`). Fetches data from the backend.
-   **Components**:
    -   **Left Panel**: `ResumeForm` for editing fields (Personal Info, Experience, etc.). Scrollable with fixed height.
    -   **Right Panel**: Live preview using the `Resume` component at 250mm width with Swiss-style shadow (`shadow-[6px_6px_0px_0px_#000000]`).
-   **Data Recovery**:
    -   Auto-saves drafts to `localStorage` under key `resume_builder_draft`.
    -   Warns user before leaving page with unsaved changes.
    -   Priority loading: API (if ID) → Context (tailor flow) → localStorage → defaults.
-   **Persistence**: Supports importing/exporting JSON. Save functionality (backend update) is a future enhancement.

### 5. Settings (`/settings`)
System configuration and status monitoring page.

#### System Status Panel
Displays real-time health and statistics:
-   **LLM Status**: Shows HEALTHY (green) or OFFLINE (red) based on provider connectivity.
-   **Database Status**: Shows CONNECTED when backend is reachable.
-   **Resumes Count**: Total number of resumes stored in the database.
-   **Jobs Count**: Total number of job descriptions stored.
-   **Improvements Count**: Total number of tailored resumes generated.
-   **Master Resume**: Shows CONFIGURED or NOT SET status.
-   **Refresh Button**: Manually refresh system status.

#### LLM Configuration
Configure the AI provider for resume tailoring:
-   **Provider Selection**: Choose from 6 providers:
    -   OpenAI (default: `gpt-4o-mini`)
    -   Anthropic (default: `claude-3-5-sonnet-20241022`)
    -   OpenRouter (default: `anthropic/claude-3.5-sonnet`)
    -   Google Gemini (default: `gemini-1.5-flash`)
    -   DeepSeek (default: `deepseek-chat`)
    -   Ollama (default: `llama3.2`, local models)
-   **Model Input**: Customize the model name for the selected provider.
-   **API Key**: Enter API key (not required for Ollama).
-   **Ollama Server URL**: Configure local Ollama endpoint (shown only for Ollama provider).

#### Actions
-   **Save Configuration**: Validates config with backend before saving.
-   **Test Connection**: Makes a test LLM call and displays success/failure result.

#### Status Footer
Shows overall system status: `STATUS: READY` or `STATUS: SETUP REQUIRED`.

## Key Components

-   **`ResumePreviewProvider`**: React Context for passing transient state (like AI generation results) between routes.
-   **`ResumeUploadDialog`**: Handles file upload to the backend with progress states.
-   **`Resume`**: Shared component for rendering the resume layout. Used in Viewer, Builder (Preview), and Dashboard (thumbnail).
    -   Width: Fills parent container (parent sets `max-w-[250mm]`)
    -   Padding: `p-10 md:p-16` for comfortable spacing
    -   Typography: Serif headers, mono metadata, sans body text
    -   No internal shadow (parent provides Swiss-style shadow)
-   **`ResumeForm`**: Form editor with collapsible sections for Personal Info, Experience, Education, Projects, and Additional info.

## State Management

-   **Local Storage**: Persists the `master_resume_id` to maintain the user's setup across sessions.
-   **URL Params**: Used to identify specific resumes for viewing (`/resumes/[id]`) or editing (`/builder?id=...`).
-   **Context API**: Used for passing immediate results from the AI tailoring process to the Builder/Viewer.

## API Client (`lib/api/`)

### Resume Operations (`lib/api/resume.ts`)
-   `uploadJobDescriptions(descriptions, resumeId)` - Upload job descriptions
-   `improveResume(resumeId, jobId)` - Generate tailored resume
-   `fetchResume(resumeId)` - Fetch resume by ID

### Configuration Operations (`lib/api/config.ts`)
-   `fetchLlmConfig()` - Get current LLM configuration
-   `updateLlmConfig(config)` - Update LLM provider/model/key
-   `fetchSystemStatus()` - Get system health and database stats
-   `testLlmConnection()` - Test LLM provider connectivity
-   `PROVIDER_INFO` - Provider metadata (names, defaults, requirements)
